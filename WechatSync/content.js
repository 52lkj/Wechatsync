!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=868)}({868:function(e,t){function n(){var e={};return e.title=document.body.getAttribute("data-msg_title"),e.content=$("#js_content").html(),e.thumb=document.body.getAttribute("data-msg_cdn_url"),e.desc=document.body.getAttribute("data-msg_desc"),e.link=window.location.href,console.log(e),e}if(setTimeout(function(){var e=document.createElement("script");e.type="text/javascript",e.innerHTML="document.body.setAttribute('data-msg_desc', msg_desc );document.body.setAttribute('data-msg_title', msg_title);document.body.setAttribute('data-msg_cdn_url', msg_cdn_url);",document.head.appendChild(e),document.head.removeChild(e)},50),console.log("accounts",s),window.location.href.indexOf("mp.weixin.qq.com/s")>-1){var o=$("<div class='sync-btn' style='position: fixed; left: 0; right: 0;top: 68px;width: 950px; margin-left: auto;margin-right: auto;'></div>");o.append('<div  data-toggle="modal" data-target="#exampleModalCenter" style=\'    font-size: 14px;border: 1px solid #eee;width: 105px; text-align: center; box-shadow: 0px 0px 1px rgba(0,0,0, 0.1);border-radius: 5px;padding: 5px; cursor: pointer;    background: rgb(0, 123, 255);color: white;\'>同步该文章</div>'),o.click(function(){a(()=>{!function(){var e=n(),t="";s=i,i.filter(e=>!e.supportTypes||e.supportTypes.indexOf("html")>-1).forEach((e,n)=>{t+='\n            <div class="form-check mb-1">\n  <input class="form-check-input" type="checkbox" value="'+e.uid+'" name="submit_check" id="defaultCheck'+n+'">\n  <label class="form-check-label" for="defaultCheck'+n+'">\n  <img src="'+(e.icon?e.icon:chrome.extension.getURL("images/wordpress.ico"))+'" class="icon" height="20" style="vertical-align: -3px;height: 20px !important"> \n  '+e.title+"\n  </label>\n</div>\n            "});var o='\n        <div class="media">\n        <img class="align-self-center mr-3" src="'+e.thumb+'" width="150" alt="Generic placeholder image">\n        <div class="media-body">\n          <h5 class="mt-0" style="font-weight:bold">'+e.title+"</h5>\n          <p>"+e.desc+'</p>\n        </div>\n      </div>\n\n      <hr>\n      <h6>账号</h6>\n      <div id="syncd-users">\n      '+t+"\n      </div>\n\n        ";$("#exampleModalCenter .modal-body").html(""),$("#exampleModalCenter .modal-body").append(o),console.log("clicka"),c()}()})}),$("#page-content").append(o)}$("body").append('\n\x3c!-- Modal --\x3e\n<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document" style="color: #444;">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="exampleModalLongTitle">同步文章</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="closesyncmodl">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        \n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal" style="font-size: 13px;    line-height: 1.5;">取消</button>\n        <button type="button" class="btn btn-primary" style="font-size: 13px;    line-height: 1.5;">同步</button>\n      </div>\n    </div>\n  </div>\n</div>\n'),chrome.runtime.onMessage.addListener(function(e,t,n){console.log("content.js revice",e);try{console.log("revice",e),"taskUpdate"==e.method&&function(e){var t=$(".alld-pubaccounts").length,n=e.accounts.map(e=>{var n=("uploading"==e.status?' <div class="lds-dual-ring"></div>'+(e.msg?e.msg:"同步中"):"")+("failed"==e.status?"同步失败, 错误内容："+e.error:"")+("done"==e.status&&e.editResp?'同步成功 <a\n                      href="'+e.editResp.draftLink+'"\n                      style="margin-left: 5px"\n                      target="_blank"\n                      >查看草稿</a\n                    >':"");if(t){var o=$("."+e.type+"-message");return o.length&&o.html(n),n}return'<div class="account-item taskStatus">\n                 '+(e.icon?' <img src="'+e.icon+'" class="icon"\n      width="20"\n      height="20"\n      style="vertical-align: -6px;height: 20px !important"\n    />':"")+'<span class="name-block">'+e.title+'</span><span\n                  style="margin-left: 15px"\n                  class="'+e.type+"-message "+e.status+' message"\n                >\n                  '+n+"</span></div>"}),o='\n  <div class="alld-pubaccounts">\n  '+n.join("\n")+"</div>";console.log(n,o),t||$("#syncd-users").html(o)}(e.task)}catch(e){console.log(e)}}),$("#exampleModalCenter .btn-primary").click(function(e){const t=l();if(!t.length)return alert("请选择账号"),e.stopPropagation();chrome.extension.sendMessage({action:"addTask",task:{post:n(),accounts:t}},function(e){console.log("addTask return",e)}),$("#syncd-users").html("等待发布...")});var i=[],s=[];function a(e){chrome.extension.sendMessage({action:"getAccount"},function(t){i=t,e&&e()})}function c(){var e=$('input[name="submit_check"]'),t=function(){if(localStorage.getItem("_sync_checked_all"))return JSON.parse(localStorage.getItem("_sync_checked_all"));return[]}();for(let n=0;n<e.length;n++){const o=e[n];t.filter(e=>e.uid==o.value).length&&(o.checked=!0)}}function l(){var e=$('input[name="submit_check"]'),t=[];for(let o=0;o<e.length;o++){const i=e[o];if(i.checked){var n=s.filter(e=>e.uid==i.value);console.log(s,i.value),t.push(n[0])}}return function(e){try{localStorage.setItem("_sync_checked_all",JSON.stringify(e))}catch(e){}}(t),t}if(window.location.href.indexOf("mp.weixin.qq.com/cgi-bin/appmsg")>-1){var d=document.createElement("script");d.type="text/javascript",d.src=chrome.extension.getURL("autoformat.js"),d.setAttribute("data-url",chrome.runtime.getURL("templates.html")),document.head.appendChild(d);const e=function(){const e=$('<div class="weui-desktop-dialog" style="position: fixed;\n    right: -25px;\n    top: 25px;\n    min-width: 350px;\n    width: 350px;\n    z-index: 99999;">\n    <div class="weui-desktop-dialog__hd" style="\n    line-height: 50px;\n    height: 50px;\n">\n  <h3 class="weui-desktop-dialog__title">同步助手</h3> \n    <button class="weui-desktop-icon-btn weui-desktop-dialog__close-btn"><svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path d="M10.01 8.996l7.922-7.922c.086-.086.085-.21.008-.289l-.73-.73c-.075-.074-.208-.075-.29.007L9 7.984 1.077.062C.995-.02.863-.019.788.055l-.73.73c-.078.078-.079.203.007.29l7.922 7.92-7.922 7.922c-.086.086-.085.212-.007.29l.73.73c.075.074.207.074.29-.008l7.92-7.921 7.922 7.921c.082.082.215.082.29.008l.73-.73c.077-.078.078-.204-.008-.29l-7.921-7.921z"></path></svg></button></div>\n    <div style="    width: 100%;\n    min-height: 300px;\n    background: white;">\n      <div id="syncd-users" style="padding: 0 32px"></div>\n    </div>\n  </div>');return $("body").append(e),e.hide(),e.find(".weui-desktop-dialog__close-btn").click(()=>{e.hide()}),e}();function r(){const t=l();console.log("prepairSubmitTask","syncform-selectbox",t),t.length?chrome.extension.sendMessage({action:"parseArticle",account:{type:"weixin"},data:{msgId:function(e,t){void 0===t&&(t=window.location.href);var n=t.match("[?&]"+e+"=([^&]+)");return n?n[1]:null}("appmsgid")}},function(n){e.show(),$("#syncd-users").html("等待发布..."),chrome.extension.sendMessage({action:"addTask",task:{post:n.article,accounts:t}},function(e){console.log("addTask return",e)}),console.log("parseArticle return",n)}):console.log("selected",0)}new MutationObserver(function(e){const t=[];for(const{addedNodes:n}of e)for(const e of n)e.tagName&&(e.classList.contains("mass-send__list")?t.push(e):e.firstElementChild&&t.push(...e.getElementsByClassName("mass-send__list")));t.length&&(console.log("onMutation.found",t),function(){a(()=>{!function(){var e='\n        <h6 style="margin-bottom: 12px">同步助手</h6> <div id="syncform-selectbox" style="padding-left: 5px">';s=i,i.filter(e=>!e.supportTypes||e.supportTypes.indexOf("html")>-1).forEach((t,n)=>{e+='\n            <div class="form-check mb-1">\n  <input class="form-check-input" type="checkbox" value="'+t.uid+'" name="submit_check" id="defaultCheck'+n+'">\n  <label class="form-check-label" for="defaultCheck'+n+'">\n  <img src="'+(t.icon?t.icon:chrome.extension.getURL("images/wordpress.ico"))+'" class="icon" height="18" style="height: 20px !important"> \n  '+t.title+"\n  </label>\n</div>\n            "}),$(".mass-send__form").append(e+"</div>"),c(),console.log("html",e)}(),setTimeout(()=>{$(".mass-send__footer .weui-desktop-btn_primary").click(()=>{console.log("clicked"),l(),function e(){const t=$(".weui-desktop-dialog__wrp").filter(function(){return $(this).text().indexOf("开始群发后无法撤销")>-1});t.length?t.find(".weui-desktop-btn_primary").click(()=>{console.log("btn clicked"),r()}):setTimeout(e,300)}()})},100)}),console.log("initSyncForm",i)}())}).observe(document,{childList:!0,subtree:!0})}}});